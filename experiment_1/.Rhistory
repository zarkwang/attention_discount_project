logit_u2$aic,
logit_c2$aic,
logit_a2$aic)
addtorow <- list()
addtorow$pos <- list(0,0,nrow(tab_mod_b),nrow(tab_mod_b))
addtorow$command  <- as.vector(c(row_mod,row_name,row_obs,row_aic),mode='character')
write_reg_tab('./tables/utility_B.tex',tab_mod_b,
var_name=var_name_delayed_u,
document=write_document,
addtorow = addtorow)
source("E:/Attention_discounting/attention_discount_project/experiment_1/make_fig_tab.R")
source("E:/Attention_discounting/attention_discount_project/experiment_1/reg_analysis.R")
fe_logit_c2
fe_logit_c2
fe_logit_c2
fe_logit_u2
logit_c1
fe_logit_c1 <- coef_confint(logit_c1,coef_name = coef_name_a1)
fe_logit_c2 <- coef_confint(logit_c2,coef_name = coef_name_a2)
library(tidyverse)
library(ggpubr)
library(gridExtra)
library(xtable)
source('reg_analysis.R')
logit_c1
logit_a1
logit_c1
summary(logit_c1)$coef
fe_logit_c1 <- coef_confint(logit_c1,coef_name = coef_name_a1)
df_time_immed$pred_logit_c <- predict(logit_c1,type='response')
df_censor_immed$pred_logit_c <- predict(logit_c1,type='response')
df_censor_immed$pred_logit_c <- predict(logit_c1,type='response')
# Delayed_Rw_Vary
q_filter2 <- df_time_delayed %>%
group_by(a_rw,b_fixed_rw,b_vary_rw) %>%
summarise(mean_choice = mean(choice)) %>%
filter(mean_choice >0 & mean_choice <1)
df_censor_delayed <- df_time_delayed %>% inner_join(q_filter2)
logit_c2 <- glm(formula_a2,
data = df_censor_delayed,
family = binomial(link='logit'))
fe_logit_c2 <- coef_confint(logit_c2,coef_name = coef_name_a2)
df_censor_delayed$pred_logit_c <- predict(logit_c2,type='response')
print('Utility model with censored data fitted')
source('reg_analysis.R')
df_time_delayed$pred_logit_c <- predict(logit_c2,type='response',newdata = df_time_delayed)
source("E:/Attention_discounting/attention_discount_project/experiment_1/make_fig_tab.R")
source("E:/Attention_discounting/attention_discount_project/experiment_1/make_fig_tab.R")
source("E:/Attention_discounting/attention_discount_project/experiment_1/make_fig_tab.R")
# Plots: Immed_Rw_Vary
firth_pred_immed <- read.csv('firth_pred_immed.csv')[,-1]
# Panel A: Immed_Rw_Vary
tab1 <- make_ci_tab(fe_logit_u1,add_var_name = TRUE)[-1,]
tab2 <- make_ci_tab(fe_logit_a1,add_var_name = TRUE)[-1,]
tab3 <- make_ci_tab(fe_logit_c1,add_var_name = TRUE)[-1,]
union_rows <- data.frame(var_name = union(rownames(tab1),rownames(tab2)))
tab1_adj <- left_join(union_rows, tab1, by = "var_name")[,-1]
tab2_adj <- left_join(union_rows, tab2, by = "var_name")[,-1]
tab3_adj <- left_join(union_rows, tab3, by = "var_name")[,-1]
tab_mod_a <- cbind(tab1_adj,tab2_adj,tab3_adj)
rownames(tab_mod_a) <- var_name_immed_u
remove(tab1,tab2,tab3,tab1_adj,tab2_adj,tab3_adj)
row_mod <- sprintf(" & \\multicolumn{2}{c}{%s} & \\multicolumn{2}{c}{%s} & \\multicolumn{2}{c}{%s} \\\\",
"(3) Utility model",
"(4) Add interation",
"(5) Censored data")
row_name <- "& Coef & 95\\% CI & Coef & 95\\% CI & Coef & 95\\% CI \\\\"
row_obs <- sprintf("\\hline observations & \\multicolumn{2}{c}{%d} & \\multicolumn{2}{c}{%d} & \\multicolumn{2}{c}{%d} \\\\",
nrow(df_time_immed),
nrow(df_time_immed),
nrow(df_censor_immed))
row_aic <- sprintf("AIC & \\multicolumn{2}{c}{%.2f} & \\multicolumn{2}{c}{%.2f} & \\multicolumn{2}{c}{%.2f} \\\\",
logit_u1$aic,
logit_a1$aic,
logit_c1$aic)
addtorow <- list()
addtorow$pos <- list(0,0,nrow(tab_mod_a),nrow(tab_mod_a))
addtorow$command  <- as.vector(c(row_mod,row_name,row_obs,row_aic),mode='character')
write_reg_tab('./tables/utility_A.tex',tab_mod_a,
var_name=var_name_immed_u,
document=write_document,
addtorow = addtorow)
# Panel A: Delayed_Rw_Vary
tab1 <- make_ci_tab(fe_logit_u2,add_var_name = TRUE)[-1,]
tab2 <- make_ci_tab(fe_logit_c2,add_var_name = TRUE)[-1,]
tab3 <- make_ci_tab(fe_logit_a2,add_var_name = TRUE)[-1,]
union_rows <- data.frame(var_name = union(rownames(tab2),rownames(tab3)))
tab1_adj <- left_join(union_rows, tab1, by = "var_name")[,-1]
tab2_adj <- left_join(union_rows, tab2, by = "var_name")[,-1]
tab3_adj <- left_join(union_rows, tab3, by = "var_name")[,-1]
tab_mod_b <- cbind(tab1_adj,tab2_adj,tab3_adj)
rownames(tab_mod_b) <- var_name_delayed_u
remove(tab1,tab2,tab3,tab1_adj,tab2_adj,tab3_adj)
row_mod <- sprintf(" & \\multicolumn{2}{c}{%s} & \\multicolumn{2}{c}{%s} & \\multicolumn{2}{c}{%s} \\\\",
"(3) Utility model",
"(4) Censored data",
"(5) Add interation")
row_name <- "& Coef & 95\\% CI & Coef & 95\\% CI & Coef & 95\\% CI \\\\"
row_obs <- sprintf("\\hline observations & \\multicolumn{2}{c}{%d} & \\multicolumn{2}{c}{%d} & \\multicolumn{2}{c}{%d} \\\\",
nrow(df_time_delayed),
nrow(df_censor_delayed),
nrow(df_time_delayed))
row_aic <- sprintf("AIC & \\multicolumn{2}{c}{%.2f} & \\multicolumn{2}{c}{%.2f} & \\multicolumn{2}{c}{%.2f} \\\\",
logit_u2$aic,
logit_c2$aic,
logit_a2$aic)
addtorow <- list()
addtorow$pos <- list(0,0,nrow(tab_mod_b),nrow(tab_mod_b))
addtorow$command  <- as.vector(c(row_mod,row_name,row_obs,row_aic),mode='character')
write_reg_tab('./tables/utility_B.tex',tab_mod_b,
var_name=var_name_delayed_u,
document=write_document,
addtorow = addtorow)
tab_mod_b
rownames(tab_mod_b) <- var_name_delayed_u
var_name_delayed_u
# Panel A: Delayed_Rw_Vary
tab1 <- make_ci_tab(fe_logit_u2,add_var_name = TRUE)[-1,]
tab2 <- make_ci_tab(fe_logit_c2,add_var_name = TRUE)[-1,]
tab3 <- make_ci_tab(fe_logit_a2,add_var_name = TRUE)[-1,]
union_rows <- data.frame(var_name = union(rownames(tab2),rownames(tab3)))
tab1_adj <- left_join(union_rows, tab1, by = "var_name")[,-1]
tab2_adj <- left_join(union_rows, tab2, by = "var_name")[,-1]
tab3_adj <- left_join(union_rows, tab3, by = "var_name")[,-1]
union_rows
union_rows <- data.frame(var_name = union(rownames(tab1),rownames(tab2)))
union_rows
tab1_adj <- left_join(union_rows, tab1, by = "var_name")[,-1]
tab2_adj <- left_join(union_rows, tab2, by = "var_name")[,-1]
tab3_adj <- left_join(union_rows, tab3, by = "var_name")[,-1]
source("E:/Attention_discounting/attention_discount_project/experiment_1/make_fig_tab.R")
fig_immed_1 <- ggplot(data = tab_immed[tab_immed$a_rw == unique(tab_immed$a_rw)[1],],
aes(x = b_vary_rw,
y = mean_choice,
color = factor(b_fixed_rw),
shape = factor(b_delay))) +
geom_point(size=2)+
geom_line(aes(y=pred_logit_a),linetype = 'dashed',alpha=0.75)+
ggtitle(paste0('(1) option A: £',unique(tab_immed$a_rw)[1], ''))+
labs(x = "immediate reward in option B (£)",
y = "probability of choosing B")+
scale_x_continuous(breaks = c(1:10)*10) +
scale_shape_discrete(name = "time length of option B (month)") +
scale_color_discrete(name = "delayed reward in option B (£)") +
theme_bw(12)+
theme(
legend.position = "bottom",
legend.box = "vertical",
legend.spacing.y = unit(-0.2, "cm"),
legend.key.width = unit(0.3, "cm"),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
text = element_text(family = "Times New Roman")
)
fig_immed_2 <- ggplot(data = tab_immed[tab_immed$a_rw == unique(tab_immed$a_rw)[2],],
aes(x = b_vary_rw,
y = mean_choice,
color = factor(b_fixed_rw),
shape = factor(b_delay))) +
geom_point(size=2)+
geom_line(aes(y=pred_logit_a),linetype='dashed',alpha=0.75)+
ggtitle(paste0('(2) option A: £',unique(tab_immed$a_rw)[2], ''))+
labs(x = "immediate reward in option B (£)",
y = "")+
scale_x_continuous(breaks = c(1:10)*10) +
scale_shape_discrete(name = "time length of option B (month)") +
scale_color_discrete(name = "delayed reward in option B (£)") +
theme_bw(12)+
theme(
legend.position = "bottom",
legend.box = "vertical",
legend.spacing.y = unit(-0.2, "cm"),
legend.key.width = unit(0.3, "cm"),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
text = element_text(family = "Times New Roman")
)
panel_immed <- ggarrange(fig_immed_1, fig_immed_2,
ncol = 2, common.legend = TRUE, legend="bottom")
# Plots: Delayed_Rw_Vary
firth_pred_delayed <- read.csv('firth_pred_delayed.csv')[,-1]
tab_delayed <- df_time_delayed %>%
group_by(b_vary_rw,a_rw,b_fixed_rw,b_delay) %>%
summarise(mean_choice = mean(choice),
pred_logit = mean(pred_logit),
pred_logit_u = mean(pred_logit_u),
pred_logit_a = mean(pred_logit_a),
pred_logit_c = mean(pred_logit_c)) %>%
left_join(firth_pred_delayed) %>%
mutate(b_vary_rw = b_vary_rw*10,
b_fixed_rw = b_fixed_rw*10,
a_rw = a_rw*10)
fig_delayed_1 <- ggplot(data = tab_delayed[tab_delayed$a_rw == unique(tab_delayed$a_rw)[1],],
aes(x = b_vary_rw,
y = mean_choice,
color = factor(b_fixed_rw))) +
geom_point(size=2)+
geom_line(aes(y=pred_logit_a),linetype='dashed',alpha=0.75)+
ggtitle(paste0('(1) option A: £',unique(tab_delayed$a_rw)[1], ''))+
labs(x = "delayed reward in option B (£)",
y = "probability of choosing B")+
scale_x_continuous(breaks = c(1:10)*10) +
scale_color_discrete(name = "immediate reward in option B (£)") +
theme_bw(12)+
theme(
legend.position = "bottom",
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
text = element_text(family = "Times New Roman")
)
fig_delayed_2 <- ggplot(data = tab_delayed[tab_delayed$a_rw == unique(tab_delayed$a_rw)[2],],
aes(x = b_vary_rw,
y = mean_choice,
color = factor(b_fixed_rw))) +
geom_point(size=2)+
geom_line(aes(y=pred_logit_a),linetype='dashed',alpha=0.75)+
ggtitle(paste0('(2) option A: £',unique(tab_delayed$a_rw)[2], ''))+
labs(x = "delayed reward in option B (£)",
y = "")+
scale_x_continuous(breaks = c(1:10)*10) +
scale_color_discrete(name = "immediate reward in option B (£)") +
theme_bw(12)+
theme(
legend.position = "bottom",
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
text = element_text(family = "Times New Roman")
)
panel_delayed <- ggarrange(fig_delayed_1, fig_delayed_2,
ncol = 2, common.legend = TRUE, legend="bottom")
title_immed <- grid::textGrob("Panel A: Immediate reward varies",
gp = grid::gpar(fontsize=14, fontfamily = "Times New Roman"))
title_delayed <- grid::textGrob("Panel B: Delayed reward varies",
gp = grid::gpar(fontsize=14, fontfamily = "Times New Roman"))
panel_immed_with_title <- arrangeGrob(title_immed, panel_immed,
heights = c(0.2,1))
panel_delayed_with_title <- arrangeGrob(title_delayed, panel_delayed,
heights = c(0.2,1))
fig_grand <- grid.arrange(panel_immed_with_title,
panel_delayed_with_title,
ncol =1,
heights = c(1.15,1))
ggsave('./figures/fig_grand_pred.png',fig_grand,device = 'png',width = 18, height = 20, units = 'cm')
source("E:/Attention_discounting/attention_discount_project/experiment_1/make_fig_tab.R")
fe_logit_c1
fe_logit_a1
fe_logit_c1
fe_logit_a1
fe_logit_c2
fe_logit_a2
fe_logit_c2
source("E:/Attention_discounting/attention_discount_project/experiment_1/make_fig_tab.R")
df_raw$duration
median(df_raw$duration)
median(df_raw$duration)/60
percent_rank(df_raw$duration)
quantile(df_raw$duration,0.8)
quantile(df_raw$duration,0.9)
quantile(df_raw$duration,0.9)/60
quantile(df_raw$duration,0.95)/60
quantile(df_raw$duration,0.92)/60
quantile(df_raw$duration,0.91)/60
quantile(df_raw$duration,0.90)/60
quantile(df_raw$duration,0.905)/60
mean(df_raw$duration)
mean(df_raw$duration)/60
ggplot(data=sum_time_equiv,
aes(x=factor(b_fixed_rw),
y=std_vary_rw))+
geom_point(aes(shape= factor(b_delay),
color= factor(a_rw)),
size = 2)+
geom_line(aes(group = interaction(b_delay, a_rw)),
linetype = 'dashed', color = 'grey') +
facet_wrap(~cond,
labeller = as_labeller(
c('Immed_Rw_Vary' = 'Immediate reward varies',
'Delayed_Rw_Vary' = 'Delayed reward varies')))+
labs(x = 'option B: the amount constant across rows (×£10)',
y = 'standard deviation') +
scale_shape_discrete(name = "option B: time length (month)") +
scale_color_discrete(name = "option A: Reward amount (×£10)") +
theme_bw(12)+
theme(
legend.position = 'top',
legend.key.width = unit(0.3, "cm"),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
text = element_text(family = "Times New Roman")
)
ggsave('./figures/fig_switch_sd.png',device = 'png',width = 18, height = 9, units = 'cm')
ggplot(data=sum_time_equiv,
aes(x=factor(b_fixed_rw),
y=std_vary_rw))+
geom_point(aes(shape= factor(b_delay),
color= factor(a_rw)),
size = 2)+
geom_line(aes(group = interaction(b_delay, a_rw)),
linetype = 'dashed', color = 'grey') +
facet_wrap(~cond,
labeller = as_labeller(
c('Immed_Rw_Vary' = 'Immediate reward varies',
'Delayed_Rw_Vary' = 'Delayed reward varies')))+
labs(x = 'the amount constant across rows in option B (×£10)',
y = 'standard deviation') +
scale_shape_discrete(name = "time length of option B (month)") +
scale_color_discrete(name = "reward amount of option A (×£10)") +
theme_bw(12)+
theme(
legend.position = 'top',
legend.key.width = unit(0.3, "cm"),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
text = element_text(family = "Times New Roman")
)
ggsave('./figures/fig_switch_sd.png',device = 'png',width = 18, height = 9, units = 'cm')
ggplot(data=sum_time_equiv,
aes(x=factor(b_fixed_rw),
y=std_vary_rw))+
geom_point(aes(shape= factor(b_delay),
color= factor(a_rw)),
size = 2)+
geom_line(aes(group = interaction(b_delay, a_rw)),
linetype = 'dashed', color = 'grey') +
facet_wrap(~cond,
labeller = as_labeller(
c('Immed_Rw_Vary' = 'Immediate reward varies',
'Delayed_Rw_Vary' = 'Delayed reward varies')))+
labs(x = 'the amount constant across rows in option B (×£10)',
y = 'standard deviation') +
scale_shape_discrete(name = "time length of option B (month)") +
scale_color_discrete(name = "reward amount of option A (×£10)") +
theme_bw(12)+
theme(
legend.position = 'top',
legend.key.width = unit(0.1, "cm"),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
text = element_text(family = "Times New Roman")
)
ggsave('./figures/fig_switch_sd.png',device = 'png',width = 18, height = 9, units = 'cm')
ggplot(data=sum_time_equiv,
aes(x=factor(b_fixed_rw),
y=std_vary_rw))+
geom_point(aes(shape= factor(b_delay),
color= factor(a_rw)),
size = 2)+
geom_line(aes(group = interaction(b_delay, a_rw)),
linetype = 'dashed', color = 'grey') +
facet_wrap(~cond,
labeller = as_labeller(
c('Immed_Rw_Vary' = 'Immediate reward varies',
'Delayed_Rw_Vary' = 'Delayed reward varies')))+
labs(x = 'the amount constant across rows in option B (×£10)',
y = 'standard deviation') +
scale_shape_discrete(name = "time length of option B (month)") +
scale_color_discrete(name = "reward amount of option A (×£10)") +
theme_bw(12)+
theme(
legend.position = 'top',
legend.box = "vertical",
legend.spacing.y = unit(-0.2, "cm"),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
text = element_text(family = "Times New Roman")
)
ggsave('./figures/fig_switch_sd.png',device = 'png',width = 18, height = 9, units = 'cm')
group_by(cond,a_rw,b_fixed_rw,b_delay) %>%
summarise(mean_vary_rw = mean(b_vary_rw),
std_vary_rw = sd(b_vary_rw))
sum_time_equiv <- df_time_equiv %>%
mutate(a_rw = a_rw*10,
b_fixed_rw = b_fixed_rw*10,
b_vary_rw = b_vary_rw*10)
sum_time_equiv <- df_time_equiv %>%
mutate(a_rw = a_rw*10,
b_fixed_rw = b_fixed_rw*10,
b_vary_rw = b_vary_rw*10) %>%
group_by(cond,a_rw,b_fixed_rw,b_delay) %>%
summarise(mean_vary_rw = mean(b_vary_rw),
std_vary_rw = sd(b_vary_rw))
ggplot(data=sum_time_equiv,
aes(x=factor(b_fixed_rw),
y=std_vary_rw))+
geom_point(aes(shape= factor(b_delay),
color= factor(a_rw)),
size = 2)+
geom_line(aes(group = interaction(b_delay, a_rw)),
linetype = 'dashed', color = 'grey') +
facet_wrap(~cond,
labeller = as_labeller(
c('Immed_Rw_Vary' = 'Immediate reward varies',
'Delayed_Rw_Vary' = 'Delayed reward varies')))+
labs(x = 'the amount constant across rows in option B (×£10)',
y = 'standard deviation') +
scale_shape_discrete(name = "time length of option B (month)") +
scale_color_discrete(name = "reward amount of option A (×£10)") +
theme_bw(12)+
theme(
legend.position = 'top',
legend.box = "vertical",
legend.spacing.y = unit(-0.2, "cm"),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
text = element_text(family = "Times New Roman")
)
ggplot(data=sum_time_equiv,
aes(x=factor(b_fixed_rw),
y=std_vary_rw))+
geom_point(aes(shape= factor(b_delay),
color= factor(a_rw)),
size = 2)+
geom_line(aes(group = interaction(b_delay, a_rw)),
linetype = 'dashed', color = 'grey') +
facet_wrap(~cond,
labeller = as_labeller(
c('Immed_Rw_Vary' = 'Immediate reward varies',
'Delayed_Rw_Vary' = 'Delayed reward varies')))+
labs(x = 'the amount constant across rows in option B (£)',
y = 'standard deviation') +
scale_shape_discrete(name = "time length of option B (month)") +
scale_color_discrete(name = "reward amount of option A (£)") +
theme_bw(12)+
theme(
legend.position = 'top',
legend.box = "vertical",
legend.spacing.y = unit(-0.2, "cm"),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
text = element_text(family = "Times New Roman")
)
ggsave('./figures/fig_switch_sd.png',device = 'png',width = 18, height = 9, units = 'cm')
ggplot(data=sum_time_equiv,
aes(x=factor(b_fixed_rw),
y=std_vary_rw))+
geom_point(aes(shape= factor(b_delay),
color= factor(a_rw)),
size = 2)+
geom_line(aes(group = interaction(b_delay, a_rw)),
linetype = 'dashed', color = 'grey') +
facet_wrap(~cond,
labeller = as_labeller(
c('Immed_Rw_Vary' = 'Immediate reward varies',
'Delayed_Rw_Vary' = 'Delayed reward varies')))+
labs(x = 'the amount constant across rows in option B (£)',
y = 'standard deviation') +
scale_shape_discrete(name = "time length of option B (month)") +
scale_color_discrete(name = "reward amount of option A (£)") +
theme_bw(12)+
theme(
legend.position = 'top',
#legend.box = "vertical",
#legend.spacing.y = unit(-0.2, "cm"),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
text = element_text(family = "Times New Roman")
)
ggsave('./figures/fig_switch_sd.png',device = 'png',width = 18, height = 9, units = 'cm')
ggplot(data=sum_time_equiv,
aes(x=factor(b_fixed_rw),
y=std_vary_rw))+
geom_point(aes(shape= factor(b_delay),
color= factor(a_rw)),
size = 2)+
geom_line(aes(group = interaction(b_delay, a_rw)),
linetype = 'dashed', color = 'grey') +
facet_wrap(~cond,
labeller = as_labeller(
c('Immed_Rw_Vary' = 'Immediate reward varies',
'Delayed_Rw_Vary' = 'Delayed reward varies')))+
labs(x = 'the amount constant across rows in option B (£)',
y = 'standard deviation') +
scale_shape_discrete(name = "time length of option B (month)") +
scale_color_discrete(name = "reward amount of option A (£)") +
theme_bw(12)+
theme(
legend.position = 'top',
#legend.box = "vertical",
#legend.spacing.y = unit(-0.2, "cm"),
legend.key.width = unit(0, "cm"),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
text = element_text(family = "Times New Roman")
)
ggsave('./figures/fig_switch_sd.png',device = 'png',width = 18, height = 9, units = 'cm')
ggplot(data=sum_time_equiv,
aes(x=factor(b_fixed_rw),
y=std_vary_rw))+
geom_point(aes(shape= factor(b_delay),
color= factor(a_rw)),
size = 2)+
geom_line(aes(group = interaction(b_delay, a_rw)),
linetype = 'dashed', color = 'grey') +
facet_wrap(~cond,
labeller = as_labeller(
c('Immed_Rw_Vary' = 'Immediate reward varies',
'Delayed_Rw_Vary' = 'Delayed reward varies')))+
labs(x = 'the amount constant across rows in option B (£)',
y = 'standard deviation') +
scale_shape_discrete(name = "time length of option B (month)") +
scale_color_discrete(name = "option A (£)") +
theme_bw(12)+
theme(
legend.position = 'top',
#legend.box = "vertical",
#legend.spacing.y = unit(-0.2, "cm"),
legend.key.width = unit(0, "cm"),
axis.title.x = element_text(margin = margin(t = 8)),
axis.title.y = element_text(margin = margin(r = 8)),
text = element_text(family = "Times New Roman")
)
ggsave('./figures/fig_switch_sd.png',device = 'png',width = 18, height = 9, units = 'cm')
