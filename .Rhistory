scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
path = 'E:/PhD Supervision/annual review/images'
ggsave(filename='common_diff.png',path=path,width=10,height=8,units='cm')
x_seq = c(1:80)
du_1 <- w(u=v(x_seq),t=t_l)* v(x_seq)
du_2 <- w(u=v(x_seq),t=t_s)* v(x_seq)
d1 <- tibble(du=du_1, x=x_seq, delay= 't_l')
d2 <- tibble(du=du_2, x=x_seq, delay= 't_s')
d_union <- bind_rows(d1,d2)
new_labels_t <- c(expression(italic("T")==16),
expression(italic("T")==8))
plot_s_value <- ggplot(d= d_union, aes(x = x,y = du, color=delay))+
geom_line()+
theme_bw(11)+
ylab("value of reward sequence")+
xlab(expression(italic(x)[italic("T")]))+
ggtitle('(b) S-shaped value function')+
theme(legend.position = c(0.8, 0.2),
text = element_text(family = "Times New Roman"))+
scale_color_hue(breaks = c('t_l','t_s'),
labels = new_labels_t)
plot_s_value
plot_s_value <- ggplot(d= d_union, aes(x = x,y = du, color=delay))+
geom_line()+
theme_bw(11)+
ylab("value of reward sequence")+
xlab(expression(italic(x)[italic("T")]))+
#ggtitle('(b) S-shaped value function')+
theme(legend.position = c(0.8, 0.2),
text = element_text(family = "Times New Roman"))+
scale_color_hue(breaks = c('t_l','t_s'),
labels = new_labels_t)
plot_s_value
# -----------------
# S-shaped value function
# -----------------
t_l
t_l = 24
x_seq = c(1:80)
du_1 <- w(u=v(x_seq),t=t_l)* v(x_seq)
du_2 <- w(u=v(x_seq),t=t_s)* v(x_seq)
d1 <- tibble(du=du_1, x=x_seq, delay= 't_l')
d2 <- tibble(du=du_2, x=x_seq, delay= 't_s')
d_union <- bind_rows(d1,d2)
new_labels_t <- c(expression(italic("T")==16),
expression(italic("T")==8))
plot_s_value <- ggplot(d= d_union, aes(x = x,y = du, color=delay))+
geom_line()+
theme_bw(11)+
ylab("value of sequence")+
xlab(expression(italic(x)[italic("T")]))+
#ggtitle('(b) S-shaped value function')+
theme(legend.position = c(0.8, 0.2),
text = element_text(family = "Times New Roman"))+
scale_color_hue(breaks = c('t_l','t_s'),
labels = new_labels_t)
plot_s_value
t_l = 16
x_seq = c(1:80)
du_1 <- w(u=v(x_seq),t=t_l)* v(x_seq)
x_seq = c(1:100)
du_1 <- w(u=v(x_seq),t=t_l)* v(x_seq)
du_2 <- w(u=v(x_seq),t=t_s)* v(x_seq)
d1 <- tibble(du=du_1, x=x_seq, delay= 't_l')
d2 <- tibble(du=du_2, x=x_seq, delay= 't_s')
d_union <- bind_rows(d1,d2)
new_labels_t <- c(expression(italic("T")==16),
expression(italic("T")==8))
plot_s_value <- ggplot(d= d_union, aes(x = x,y = du, color=delay))+
geom_line()+
theme_bw(11)+
ylab("value of sequence")+
xlab(expression(italic(x)[italic("T")]))+
#ggtitle('(b) S-shaped value function')+
theme(legend.position = c(0.8, 0.2),
text = element_text(family = "Times New Roman"))+
scale_color_hue(breaks = c('t_l','t_s'),
labels = new_labels_t)
plot_s_value
plot_s_value <- ggplot(d= d_union, aes(x = x,y = du, color=delay))+
geom_line()+
theme_bw(11)+
ylab("value of sequence")+
xlab(expression(italic(x)[italic("T")]))+
#ggtitle('(b) S-shaped value function')+
theme(legend.position = c(0.2, 0.8),
text = element_text(family = "Times New Roman"))+
scale_color_hue(breaks = c('t_l','t_s'),
labels = new_labels_t)
plot_s_value
x_seq = c(1:200)
du_1 <- w(u=v(x_seq),t=t_l)* v(x_seq)
du_2 <- w(u=v(x_seq),t=t_s)* v(x_seq)
d1 <- tibble(du=du_1, x=x_seq, delay= 't_l')
d2 <- tibble(du=du_2, x=x_seq, delay= 't_s')
d_union <- bind_rows(d1,d2)
new_labels_t <- c(expression(italic("T")==16),
expression(italic("T")==8))
plot_s_value <- ggplot(d= d_union, aes(x = x,y = du, color=delay))+
geom_line()+
theme_bw(11)+
ylab("value of sequence")+
xlab(expression(italic(x)[italic("T")]))+
#ggtitle('(b) S-shaped value function')+
theme(legend.position = c(0.2, 0.8),
text = element_text(family = "Times New Roman"))+
scale_color_hue(breaks = c('t_l','t_s'),
labels = new_labels_t)
plot_s_value
x_seq = c(1:300)
du_1 <- w(u=v(x_seq),t=t_l)* v(x_seq)
du_2 <- w(u=v(x_seq),t=t_s)* v(x_seq)
d1 <- tibble(du=du_1, x=x_seq, delay= 't_l')
d2 <- tibble(du=du_2, x=x_seq, delay= 't_s')
d_union <- bind_rows(d1,d2)
new_labels_t <- c(expression(italic("T")==16),
expression(italic("T")==8))
plot_s_value <- ggplot(d= d_union, aes(x = x,y = du, color=delay))+
geom_line()+
theme_bw(11)+
ylab("value of sequence")+
xlab(expression(italic(x)[italic("T")]))+
#ggtitle('(b) S-shaped value function')+
theme(legend.position = c(0.2, 0.8),
text = element_text(family = "Times New Roman"))+
scale_color_hue(breaks = c('t_l','t_s'),
labels = new_labels_t)
plot_s_value
plot_s_value <- ggplot(d= d_union, aes(x = x,y = du, color=delay))+
geom_line()+
theme_bw(11)+
ylab("value of sequence")+
xlab(expression(italic(x)[italic("T")]))+
#ggtitle('(b) S-shaped value function')+
theme(legend.position = c(0.15, 0.8),
text = element_text(family = "Times New Roman"))+
scale_color_hue(breaks = c('t_l','t_s'),
labels = new_labels_t)
plot_s_value
ggsave(filename='s_shape_value.png',path=path,width=10,height=8,units='cm')
plot_com <- ggplot(data = d_com[d_com$t_s<11,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_1[1], linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = x_breaks)+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
path = 'E:/PhD Supervision/annual review/images'
ggsave(filename='common_diff.png',path=path,width=10,height=8,units='cm')
getwd()
att_choice <- read.csv('model/example_att_choice.csv')
inatt_choice <- read.csv('model/example_inatt_choice.csv')
a_labels <- c(expression(italic(t)==0),
expression(italic(t)==1),
expression(italic(t)==2),
expression(italic(t)==3))
plot_att<- ggplot(d = att_choice,
aes(x=period,y=consumption,color=as.factor(decision_step)))+
geom_line()+
theme_bw(11)+
labs(color='decision step',x='period')+
ggtitle('(a) With learning')+
theme(legend.position = 'None',
text = element_text(family = "Times New Roman"))
plot_inatt<- ggplot(d = inatt_choice,
aes(x=period,y=consumption,color=as.factor(decision_step)))+
geom_line()+
theme_bw(11)+
labs(color='decision step',x = expression(italic(t)))+
ggtitle('(b) Without learning')+
theme(text = element_text(family = "Times New Roman"))+
scale_color_hue(breaks = as.factor(0:3),
labels = a_labels)
gridplot2 <- arrangeGrob(plot_att,plot_inatt,ncol=2,widths=c(1, 1.3))
path = 'rmarkdown/images/plot-budget-dynamic.png'
ggsave(path,gridplot2,width=16.5,height=7,units='cm')
plot_att<- ggplot(d = att_choice,
aes(x=period,y=consumption,color=as.factor(decision_step)))+
geom_line()+
theme_bw(11)+
labs(color='decision step',x='period')+
ggtitle('(a) with learning')+
theme(legend.position = 'None',
text = element_text(family = "Times New Roman"))
plot_inatt<- ggplot(d = inatt_choice,
aes(x=period,y=consumption,color=as.factor(decision_step)))+
geom_line()+
theme_bw(11)+
labs(color='decision step',x = expression(italic(t)))+
ggtitle('(b) without learning')+
theme(text = element_text(family = "Times New Roman"))+
scale_color_hue(breaks = as.factor(0:3),
labels = a_labels)
gridplot2 <- arrangeGrob(plot_att,plot_inatt,ncol=2,widths=c(1, 1.3))
path = 'rmarkdown/images/plot-budget-dynamic.png'
ggsave(path,gridplot2,width=16.5,height=7,units='cm')
library(tidyverse)
library(grid)
library(gridExtra)
library(png)
library(extrafont)
g <- function(t){
1/(1-delta)*(delta^(-t)-1)
}
# weight function
w <- function(u,t){
1 / (1+g(t)*exp(-u/lambda))
}
# utility function
v <- function(x){
x^gamma/lambda
}
delta = 0.75
gamma = 0.6
lambda = 2
t_l = 16
t_s = 8
x_l = 30
x_s = 10
find_equiv <- function(u_l,u_s,t_s){
t_seq_list = t_s+c(0:1000)*0.1
obj <- abs(w(u_s,t_s)*u_s - w(u_l,t_seq_list)*u_l)
eq_idx <- which(obj == min(obj))
t_l <- t_seq_list[eq_idx]
return(t_l)
}
u_l_low = v(30)
u_s_low = v(10)
u_l_high = v(120)
u_s_high = v(100)
t_l_equiv_1 <- sapply(t_seq,
function(t_s) find_equiv(u_l=u_l_low,u_s=u_s_low,t_s))
t_l_equiv_2 <- sapply(t_seq,
function(t_s) find_equiv(u_l=u_l_high,u_s=u_s_high,t_s))
df_common_diff_1 <- tibble(u_l = u_l_low,
u_s = u_s_low,
t_s = t_seq,
t_l_equiv = t_l_equiv_1,
cond = 'low_reward')
df_common_diff_2 <- tibble(u_l = u_l_high,
u_s = u_s_high,
t_s = t_seq,
t_l_equiv = t_l_equiv_2,
cond = 'high_reward')
d_com <- bind_rows(df_common_diff_1,df_common_diff_2)
new_labels_xx <- c(expression(italic(x)[italic(l)]==30~","~italic(x)[italic(s)]==10),
expression(italic(x)[italic(l)]==120~","~italic(x)[italic(s)]==100))
plot_com <- ggplot(data = d_com[d_com$t_s<11,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_1[1], linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = x_breaks)+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>1,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_1[1], linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = x_breaks)+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>0.5,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_1[1], linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = x_breaks)+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
t_s
td_com$_s
d_com$_s
d_com$t_s
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>0,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_1[1], linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = x_breaks)+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
x_breaks
d_com$t_s
d_com <- bind_rows(df_common_diff_1,df_common_diff_2)
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>0,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_1[2], linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = x_breaks)+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>0,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_2[2], linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = x_breaks)+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>0,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_2[1], linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = x_breaks)+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>0,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_2[1], linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = c(1,3,5,7,9))+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>0,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_2[1]-0.1, linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = c(1,3,5,7,9))+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>0,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_2[1]-0.2, linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = c(1,3,5,7,9))+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>0,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_2[1]-0.3, linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = c(1,3,5,7,9))+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>0,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_2[1]-0.3, linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.8))+
scale_x_continuous(breaks = c(1,3,5,7,9))+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13.5, size=3,
label = paste0(45, "째"))
plot_com
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>0,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_2[1]-0.3, linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = c(1,3,5,7,9))+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 13, size=3,
label = paste0(45, "째"))
plot_com
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>0,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_2[1]-0.3, linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = c(1,3,5,7,9))+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 12.9, size=3,
label = paste0(45, "째"))
plot_com
plot_com <- ggplot(data = d_com[d_com$t_s<11&d_com$t_s>0,],aes(x = t_s,y = t_l_equiv, color = cond))+
geom_line()+
geom_abline(slope=1,intercept = t_l_equiv_2[1]-0.3, linetype ='dashed')+
theme_bw(11)+
ylim(c(0,17))+
labs(color = 'reward',
x = expression(italic(t)[italic(s)]),
y = expression("equivalent long delay" ~~ italic(t)[italic(l)]))+
theme(text = element_text(family = "Times New Roman"),
legend.position = c(0.24, 0.82))+
scale_x_continuous(breaks = c(1,3,5,7,9))+
scale_color_hue(breaks = c('low_reward','high_reward'),
labels = new_labels_xx)+
annotate("text",x = 9.5,y = 12.8, size=3,
label = paste0(45, "째"))
plot_com
path = 'E:/PhD Supervision/annual review/images'
ggsave(filename='common_diff.png',path=path,width=10,height=8,units='cm')
t_l_equiv_1
t_l_equiv_2
t_conc = c(0:50)
