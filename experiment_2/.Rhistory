data <- read_excel(file_path, sheet = sheet_name)[,-1]
data
columns(data)
View(data)
# 移除 indiff_point 大于 500 的观测值
data_filtered <- data[data$indiff_point <= 500, ]
# 跑线性回归模型
model <- lm(value_surplus ~ front_amount + factor(worker_id) + factor(seq_length), data = data_filtered)
# 查看回归结果
summary(model)
# 跑线性回归模型
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id), data = data_filtered)
# 查看回归结果
summary(model)
library(readxl)
file_path <- "E:/Attention_discounting/mydata/pilot_4_data_20240114.xlsx"
sheet_name <- "intertemporal_results"
data <- read_excel(file_path, sheet = sheet_name)[,-1]
# remove outlier
data_filtered <- data[data$indiff_point <= 500, ]
# linear regression - fixed intercept
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id), data = data_filtered)
# result
summary(model)
?pnorm
qnorm(0.975)
qnorm(1-sig.level/2)
sig.level <- 0.05
power <- 0.7
qnorm(1-sig.level/2)
qnorm(1-sig.level/2)+qnorm(1-power)
library(readxl)
file_path <- "E:/Attention_discounting/mydata/pilot_4_data_20240114.xlsx"
sheet_name <- "intertemporal_results"
data <- read_excel(file_path, sheet = sheet_name)[,-1]
# remove outlier
data_filtered <- data[data$indiff_point <= 500, ]
# linear regression - fixed intercept
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id), data = data_filtered)
# result
summary(model)
summary(model)@coef
summary(model)$coef
summary(model)$coef[-1,]
summary(model)$coef[:1,]
summary(model)$coef[:-1,]
summary(model)$coef[1:-1,]
summary(model)$coef[-1:1,]
summary(model)$coef[1:1,]
summary(model)$coef[-1,]
summary(model)$coef[-1:2,]
summary(model)$coef[-1:-2,]
coef <- summary(model)$coef
shape(coef)
nrow(coef)
coef[nrow(coef)-1:nrow(coef),]
coef
coef[nrow(coef)-1:nrow(coef),]
summary(model)$coef
summary(model)$coef[-1:1,]
summary(model)$coef[1:-1,]
summary(model)$coef[0:-1,]
summary(model)$coef[1:-1,]
summary(model)$coef[0:-1,]
summary(model)$coef[0:1,]
summary(model)$coef[-1:0,]
coef[(nrow(coef)-1):nrow(coef),]
coef[(nrow(coef)-1):nrow(coef),1]
coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]
((qnorm(1-sig.level/2)+qnorm(1-power))/(-4.338711))^2
coef[(nrow(coef)-1):nrow(coef),1]/
coef[(nrow(coef)-1):nrow(coef),2]
coef[(nrow(coef)-1):nrow(coef),1]/
coef[(nrow(coef)-1):nrow(coef),2]
coef[(nrow(coef)-1):nrow(coef),1]/
coef[(nrow(coef)-1):nrow(coef),3]
coef[(nrow(coef)-1):nrow(coef),1]/
coef[(nrow(coef)-1):nrow(coef),]
coef[(nrow(coef)-1):nrow(coef),]
coef[(nrow(coef)-1):nrow(coef),]$Estimate
coef[(nrow(coef)-1):nrow(coef),1]
coef[(nrow(coef)-1):nrow(coef),2]
coef[(nrow(coef)-1):nrow(coef),1]/
0.03887042/ 0.008958978
0.03887042/ 0.008958978
((qnorm(1-sig.level/2)+qnorm(1-power))/(-4.338711))^2
coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20)
((qnorm(1-sig.level/2)+qnorm(1-power))/(-0.9701653))^2
((qnorm(1-sig.level/2)+qnorm(1-power))/(-0.9157449))^2
coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20)
coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20)
coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*12-20+1)
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*12-20+1)
min(low)
min(abs(low))
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*12-20+1)
low <-min(abs(low))
up <- qnorm(1-sig.level/2)+qnorm(1-power)
(up/low)^2
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*12)
low <-min(abs(low))
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*12)
low <-min(abs(low))
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*12)
low <-min(abs(low))
up <- qnorm(1-sig.level/2)+qnorm(1-power)
(up/low)^2
sig.level <- 0.05
power <- 0.8
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*12)
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*12)
low <-min(abs(low))
up <- qnorm(1-sig.level/2)+qnorm(1-power)
(up/low)^2
sig.level <- 0.05
power <- 0.8
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*12)
low <-min(abs(low))
up <- qnorm(1-sig.level/2)+qnorm(1-power)
(up/low)^2
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*12-20)
low <-min(abs(low))
up <- qnorm(1-sig.level/2)+qnorm(1-power)
(up/low)^2
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*14)
low <-min(abs(low))
up <- qnorm(1-sig.level/2)+qnorm(1-power)
(up/low)^2
sig.level <- 0.01
power <- 0.8
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*14)
low <- min(abs(low))
up <- qnorm(1-sig.level/2)+qnorm(1-power)
(up/low)^2
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*14-20)
low <- min(abs(low))
up <- qnorm(1-sig.level/2)+qnorm(1-power)
(up/low)^2
sig.level <- 0.05
power <- 0.8
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*14)
low <- min(abs(low))
up <- qnorm(1-sig.level/2)+qnorm(1-power)
(up/low)^2
sig.level <- 0.05
power <- 0.8
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*14)
low <- min(abs(low))
up <- qnorm(1-sig.level/2)+qnorm(1-power)
(up/low)^2
sig.level <- 0.05
power <- 0.8
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*14)
low <- min(abs(low))
up <- qnorm(1-sig.level/2)+qnorm(1-power)
(up/low)^2
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*13)
low <- min(abs(low))
up <- qnorm(1-sig.level/2)+qnorm(1-power)
(up/low)^2
low <- coef[(nrow(coef)-1):nrow(coef),1]/coef[(nrow(coef)-1):nrow(coef),2]/sqrt(20*15)
low <- min(abs(low))
up <- qnorm(1-sig.level/2)+qnorm(1-power)
(up/low)^2
library(haven)
read_dta('C:/Users/zarkwang/Desktop/GPS_dataset_country_level/country.dta')
df_gps <- read_dta('C:/Users/zarkwang/Desktop/GPS_dataset_country_level/country.dta')
View(df_gps)
setwd('E:/Attention_discounting/experiment_2')
library('tidyverse')
df_time_valid <- read.csv('valid_sequence_data.csv')
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[4])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[4]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[5])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[5]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + choice_label + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + fron_amount^2 + choice_label + factor(worker_id),
data = df_filtered)
model <- lm(value_surplus ~ front_amount:seq_length + front_amount^2 + choice_label + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + I(front_amount^2) + choice_label + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length  + choice_label + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + seq_length + choice_label + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + choice_label + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length +  factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + choice_label + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + choice_label,
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + choice_label + factor(worker_id),
data = df_filtered)
summary(model)
library('lme4')
model <- lmer(value_surplus ~ front_amount:seq_length + choice_label + (1|worker_id),
data = df_filtered)
summary(model)
confint(model)
model <- lmer(value_surplus ~ front_amount:seq_length + (1|worker_id),
data = df_filtered)
summary(model)
confint(model)
confint.default(model)
confint(model)
model <- lmer(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + (1|worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
model <- lmer(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
model <- lmer(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
sort(df_time_valid$value_surplus)
sort(df_time_valid$value_surplus)[1:5]
sort(df_time_valid$value_surplus)[1:7]
sort(df_time_valid$value_surplus,decreasing = TRUE)
sort(df_time_valid$value_surplus,decreasing = TRUE)[1:6]
sort(df_time_valid$value_surplus,decreasing = TRUE)[1:7]
nrow(df_time_valid)
12/ nrow(df_time_valid)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[6])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[6]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + (1|worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[5])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[5]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
sort(df_time_valid$value_surplus)[1:8]
sort(df_time_valid$value_surplus,decreasing=TRUE)[1:8]
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[6])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[6]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[8])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[8]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[7])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[7]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[6])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[6]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
confint(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[5])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[5]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[4])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[4]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[5])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[5]),]
sort(df_time_valid$value_surplus,decreasing=TRUE)[1:5]
sort(df_time_valid$value_surplus,decreasing=TRUE)[1:6]
sort(df_time_valid$value_surplus,decreasing=TRUE)[1:8]
sort(df_time_valid$value_surplus,decreasing=TRUE)[1:10]
sort(df_time_valid$value_surplus,decreasing=TRUE)[1:120]
sort(df_time_valid$value_surplus)[1:120]
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[3])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[3]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[5])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[5]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[4])&
(df_time_valid$value_surplus< sort(df_time_valid$value_surplus,decreasing = TRUE)[4]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
sort(df_time_valid$value_surplus)[1:10]
sort(df_time_valid$value_surplus,decreasing=T)[1:10]
model <- lm(indiff_point ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
model <- lm(value_surplus ~ front_amount + factor(worker_id),
data = df_filtered)
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[6])&
(df_time_valid$value_surplus < sort(df_time_valid$value_surplus,decreasing = TRUE)[6]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
sort(df_time_valid$value_surplus,decreasing=T)[1:10]
sort(df_time_valid$value_surplus)[1:10]
12 / nrow(df_time_valid)
8 / nrow(df_time_valid) #0.55%
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[4])&
(df_time_valid$value_surplus < sort(df_time_valid$value_surplus,decreasing = TRUE)[4]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[6])&
(df_time_valid$value_surplus < sort(df_time_valid$value_surplus,decreasing = TRUE)[6]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
20 / nrow(df_time_valid)
25 / nrow(df_time_valid)
24 / nrow(df_time_valid)
22 / nrow(df_time_valid)
20 / nrow(df_time_valid)
22 / nrow(df_time_valid)
sort(df_time_valid$value_surplus,decreasing=T)[1:15]
sort(df_time_valid$value_surplus)[1:15]
12 / nrow(df_time_valid)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[6])&
(df_time_valid$value_surplus < sort(df_time_valid$value_surplus,decreasing = TRUE)[6]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
library('MASS')
model <- rlm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_time_valid, maxit=100)
summary(model)
confint.default(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > 0)&
(df_time_valid$value_surplus< 60),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
df_choice_vary <- df_time_valid %>%
select(worker_id,value_surplus) %>%
mutate(total_money = value_surplus == 60) %>%
group_by(worker_id) %>%
summarize(sum_total_money = sum(total_money),
sd_value = sd(value_surplus))
id_list <- df_choice_vary[df_choice_vary$sd_value > quantile(df_choice_vary$sd_value,0.5),]$worker_id
id_list <- df_choice_vary[df_choice_vary$sum_total_money <14,]$worker_id
df_filtered <- df_time_valid[df_time_valid$worker_id %in% id_list,]
df_choice_vary <- df_time_valid %>%
select(worker_id,value_surplus) %>%
mutate(total_money = value_surplus == 60) %>%
group_by(worker_id) %>%
summarize(sum_total_money = sum(total_money),
sd_value = sd(value_surplus))
id_list <- df_choice_vary[df_choice_vary$sum_total_money < 14,]$worker_id
df_time_valid <- df_time_valid[df_time_valid$worker_id %in% id_list,]
df_choice_vary <- df_time_valid %>%
select(worker_id,value_surplus) %>%
mutate(total_money = value_surplus == 60) %>%
group_by(worker_id) %>%
summarize(sum_total_money = sum(total_money),
sd_value = sd(value_surplus))
df_choice_vary <- df_time_valid %>%
select(worker_id,value_surplus) %>%
mutate(total_money = value_surplus == 60) %>%
group_by(worker_id) %>%
summarize(sum_total_money = sum(total_money),
sd_value = sd(value_surplus))
id_list <- df_choice_vary[df_choice_vary$sum_total_money < 14,]$worker_id
df_choice_vary <- df_time_valid %>%
select(worker_id,value_surplus) %>%
mutate(total_money = value_surplus == 60) %>%
group_by(worker_id) %>%
summarize(sum_total_money = sum(total_money),
sd_value = sd(value_surplus))
df_choice_vary <- df_time_valid %>%
select(worker_id,value_surplus) %>%
mutate(total_money = value_surplus == 60) %>%
group_by(worker_id) %>%
summarize(sum_total_money = sum(total_money),
sd_value = sd(value_surplus))
library('tidyverse')
df_choice_vary <- df_time_valid %>%
select(worker_id,value_surplus) %>%
mutate(total_money = value_surplus == 60) %>%
group_by(worker_id) %>%
summarize(sum_total_money = sum(total_money),
sd_value = sd(value_surplus))
df_choice_vary <- df_time_valid %>%
select(worker_id,value_surplus)
df_time_valid <- read.csv('valid_sequence_data.csv')
df_choice_vary <- df_time_valid %>%
select(worker_id,value_surplus) %>%
mutate(total_money = value_surplus == 60) %>%
group_by(worker_id) %>%
summarize(sum_total_money = sum(total_money),
sd_value = sd(value_surplus))
id_list <- df_choice_vary[df_choice_vary$sum_total_money < 14,]$worker_id
df_time_valid %>%
select(worker_id,value_surplus)
df_time_valid
df_time_valid$worker_id
df_choice_vary <- df_time_valid %>%
select(worker_id,value_surplus) %>%
mutate(total_money = value_surplus == 60) %>%
group_by(worker_id) %>%
summarize(sum_total_money = sum(total_money),
sd_value = sd(value_surplus))
columns(df_time_valid)
colnames(df_time_valid)
library('tidyverse')
library('lme4')
df_time_valid <- read.csv('valid_sequence_data.csv')
df_choice_vary <- df_time_valid %>%
select(worker_id,value_surplus) %>%
mutate(total_money = value_surplus == 60) %>%
group_by(worker_id) %>%
summarize(sum_total_money = sum(total_money),
sd_value = sd(value_surplus))
dplyr::select(df_time_valid, worker_id, value_surplus) %>%
dplyr::mutate(total_money = value_surplus == 60) %>%
dplyr::group_by(worker_id) %>%
dplyr::summarize(sum_total_money = sum(total_money),
sd_value = sd(value_surplus))
library('dplyr')
df_choice_vary <- df_time_valid %>%
select(worker_id,value_surplus) %>%
mutate(total_money = value_surplus == 60) %>%
group_by(worker_id) %>%
summarize(sum_total_money = sum(total_money),
sd_value = sd(value_surplus))
df_choice_vary <-dplyr::select(df_time_valid, worker_id, value_surplus) %>%
dplyr::mutate(total_money = value_surplus == 60) %>%
dplyr::group_by(worker_id) %>%
dplyr::summarize(sum_total_money = sum(total_money),
sd_value = sd(value_surplus))
id_list <- df_choice_vary[df_choice_vary$sum_total_money < 14,]$worker_id
df_time_valid <- df_time_valid[df_time_valid$worker_id %in% id_list,]
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[6])&
(df_time_valid$value_surplus < sort(df_time_valid$value_surplus,decreasing = TRUE)[6]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
confint(model)
ggplot(data=df_choice_vary)+
geom_histogram(aes(x=sd_value))
library('MASS')
model <- rlm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_time_valid, maxit=100)
summary(model)
confint.default(model)
id_list <- df_choice_vary[df_choice_vary$sd_value > 0,]$worker_id
df_time_valid <- df_time_valid[df_time_valid$worker_id %in% id_list,]
df_filtered <- df_time_valid[(df_time_valid$value_surplus > 0)&
(df_time_valid$value_surplus < 60),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
df_filtered <- df_time_valid[(df_time_valid$value_surplus > sort(df_time_valid$value_surplus)[6])&
(df_time_valid$value_surplus < sort(df_time_valid$value_surplus,decreasing = TRUE)[6]),]
model <- lm(value_surplus ~ front_amount:seq_length + factor(worker_id),
data = df_filtered)
summary(model)
